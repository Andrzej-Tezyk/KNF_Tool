<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Streaming Document Processing</title>
    <script src="https://unpkg.com/htmx.org"></script>
    <script src="https://unpkg.com/htmx.org/dist/ext/sse.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .output-content {
            border: 1px solid #ddd;
            padding: 10px;
            margin: 10px 0;
            background-color: #f9f9f9;
        }
        .markdown-body {
            font-size: 14px;
            line-height: 1.6;
        }
        .error {
            color: red;
        }
    </style>
</head>
<body>
    <h1>Document Processing</h1>
    <form id="processing-form" hx-post="/process" hx-trigger="submit" hx-target="#results" hx-swap="beforeend">
        <label for="input">Prompt:</label>
        <input type="text" id="input" name="input" required>
        <button type="submit">Process Documents</button>
        <button type="button" hx-get="/stop_processing" hx-target="#results" hx-swap="beforeend">Stop Processing</button>
    </form>
    <div id="results" hx-sse="connect:/sse"></div>

    <script>
        document.addEventListener("htmx:beforeRequest", function (event) {
            const target = document.getElementById("results");
            if (event.detail.verb === "POST") {
                target.innerHTML = ""; // Clear previous results
            }
        });
    </script>
</body>
</html>
